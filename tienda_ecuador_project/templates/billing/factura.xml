<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<factura id="comprobante" version="1.1.0">
    <infoTributaria>
        <ambiente>{{ info_tributaria.ambiente }}</ambiente>
        <tipoEmision>{{ info_tributaria.tipo_emision }}</tipoEmision>
        <razonSocial>{{ info_tributaria.razon_social }}</razonSocial>
        {% if info_tributaria.nombre_comercial %}<nombreComercial>{{ info_tributaria.nombre_comercial }}</nombreComercial>{% endif %}
        <ruc>{{ info_tributaria.ruc }}</ruc>
        <claveAcceso>{{ info_tributaria.clave_acceso }}</claveAcceso>
        <codDoc>{{ info_tributaria.cod_doc }}</codDoc>
        <estab>{{ info_tributaria.establecimiento }}</estab>
        <ptoEmi>{{ info_tributaria.punto_emision }}</ptoEmi>
        <secuencial>{{ info_tributaria.secuencial }}</secuencial>
        <dirMatriz>{{ info_tributaria.direccion_matriz }}</dirMatriz>
    </infoTributaria>
    <infoFactura>
        <fechaEmision>{{ info_factura.fecha_emision }}</fechaEmision>
        {% if info_factura.direccion_establecimiento %}<dirEstablecimiento>{{ info_factura.direccion_establecimiento }}</dirEstablecimiento>{% endif %}
        {% if info_factura.contribuyente_especial %}<contribuyenteEspecial>{{ info_factura.contribuyente_especial }}</contribuyenteEspecial>{% endif %}
        <obligadoContabilidad>{% if info_factura.obligado_contabilidad %}SI{% else %}NO{% endif %}</obligadoContabilidad>
        <tipoIdentificacionComprador>{{ "{0:02}.format(info_factura.tipo_identificacion_comprador) }}</tipoIdentificacionComprador>
        <razonSocialComprador>{{ info_factura.razon_social_comprador }}</razonSocialComprador>
        <identificacionComprador>{{ info_factura.identificacion_comprador }}</identificacionComprador>
        <totalSinImpuestos>{{ "{0:.2f}".format(info_factura.total_sin_impuestos) }}</totalSinImpuestos>
        <totalDescuento>{{ "{0:.2f}".format(info_factura.total_descuento) }}</totalDescuento>
        <totalConImpuestos>
            {% for impuesto in info_factura.impuestos %}
            <totalImpuesto>
                <codigo>{{ impuesto.codigo }}</codigo>
                <codigoPorcentaje>{{ impuesto.porcentaje }}</codigoPorcentaje>
				<descuentoAdicional>{{ impuesto.descuento_adicional }}</descuentoAdicional>
                <baseImponible>{{ "{0:.2f}".format(impuesto.base_imponible) }}</baseImponible>
                <valor>{{ "{0:.2f}".format(impuesto.valor) }}</valor>
            </totalImpuesto>
            {% endfor %}
        </totalConImpuestos>
        <propina>{{ "{0:.2f}".format(info_factura.propina) }}</propina>
        <importeTotal>{{ "{0:.2f}".format(info_factura.importe_total) }}</importeTotal>
        <moneda>{{ info_factura.moneda }}</moneda>
    </infoFactura>
    <detalles>
        {% for detalle in detalles %}
        <detalle>
            {% if detalle.codigo_principal %}<codigoPrincipal>{{ detalle.codigo_principal }}</codigoPrincipal>{% endif %}
            {% if detalle.codigo_auxiliar %}<codigoAuxiliar>{{ detalle.codigo_auxiliar }}</codigoAuxiliar>{% endif %}
            <descripcion>{{ detalle.descripcion }}</descripcion>
            {% if detalle.unidad_medida %}<unidadMedida>{{ detalle.unidad_medida }}</unidadMedida>{% endif %}
            <cantidad>{{ "{0:.6f}".format(detalle.cantidad) }}</cantidad>
            <precioUnitario>{{ "{0:.6f}".format(detalle.precio_unitario) }}</precioUnitario>
            <descuento>{{ "{0:.2f}".format(detalle.descuento) }}</descuento>
            <precioTotalSinImpuesto>{{ "{0:.2f}".format(detalle.precio_total_sin_impuesto) }}</precioTotalSinImpuesto>
            <impuestos>
                {% for impuesto in detalle.impuestos %}
                <impuesto>
                    <codigo>{{ impuesto.codigo }}</codigo>
                    <codigoPorcentaje>{{ impuesto.codigo_porcentaje }}</codigoPorcentaje>
                    <tarifa>{{ "{0:.2f}".format(impuesto.tarifa) }}</tarifa>
                    <baseImponible>{{ "{0:.2f}".format(impuesto.base_imponible) }}</baseImponible>
                    <valor>{{ "{0:.2f}".format(impuesto.valor) }}</valor>
                </impuesto>
                {% endfor %}
            </impuestos>
        </detalle>
        {% endfor %}
    </detalles>
	<retenciones>
        {% for retencion in retenciones %}
        <retencion>
            <codigo>{{ retencion.codigo }}</codigo>
            <codigoPorcentaje>{{ retencion.codigo_porcentaje }}</codigoPorcentaje>
            <tarifa>{{ "{0:.2f}".format(retencion.tarifa) }}</tarifa>	    
            <valor>{{ "{0:.2f}".format(retencion.valor) }}</valor>
        </retencion>
        {% endfor %}
    </retenciones>
    {% if info_adicional %}
    <infoAdicional>
        {% for k,v in info_adicional %}
        <campoAdicional nombre="{{ k }}">{{ v }}</campoAdicional>
        {% endfor %}
    </infoAdicional>
    {% endif %}
</factura>
