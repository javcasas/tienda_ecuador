{% extends 'billing/l2_proformabill_selected.html' %}
{% load bootstrap3 %}

{% block title %}Ver Proforma {{ proformabill }} - {{ block.super }}{% endblock %}


{% block body %}
    {{ block.super }}
    <div class='col-xs-12'>
        <h2>Emitir Proforma</h2>
        <p>Por favor, compruebe los datos de la proforma.</p>
        {% if msgs %}
            <h3>Hubo errores en la factura</h3>
            {% for msg in msgs %}
                <p>
                {{ msg.tipo }}, {{ msg.identificador }}, {{ msg.mensaje }}, {{ msg.informacionAdicional }}
                </p>
            {% endfor %}
        {% endif %}

        <h3 class='spaced-top'>Cliente</h3>
        <table class='table table-bordered'>
            <tr>
                <th>Numero</th><td>{{ proformabill.number }}</td>
            </tr>
            <tr>
                <th>Cliente</th><td>({{ proformabill.issued_to.tipo_identificacion }}) {{ proformabill.issued_to.identificacion }} </td>
            </tr>
            <tr>
                 <th></th><td>{{ proformabill.issued_to.razon_social }}</td>
            </tr>
            <tr>
                <th>Fecha</th><td>{{ proformabill.date }}</td>
            </tr>
        </table>

        <h3 class='spaced-top'>Detalle</h3>
        <table class='table table-bordered'>
            <tr>
                <th>CÃ³digo</th>
                <th>Nombre</th>
                <th>Cantidad</th>
                <th>Precio unitario</th>
                <th>Subtotal</th>
                <th>Impuestos</th>
            </tr>
        {% for item in proformabill.items %}
            <tr>
                <td>{{ item.sku }}</td>
                <td>{{ item.name }}</td>
                <td>{{ item.qty }}</td>
                <td>{{ item.unit_price|floatformat:4 }}</td>
                <td>{{ item.subtotal|floatformat:2 }}</td>
                <td>{{ item.total_impuestos|floatformat:2 }}</td>
            <tr/>
        {% endfor %}
        </table>

        <h3 class='spaced-top'>Totales</h3>
        <table class='table table-bordered'>
            <tr>
                <th>Subtotal IVA 12%</th><td>{{ proformabill.subtotal.12|floatformat:2 }}</td>
            </tr>
            <tr>
                <th>Subtotal IVA 0%</th><td>{{ proformabill.subtotal.0|floatformat:2 }}</td>
            </tr>
            <tr>
                <th>IVA 12%</th><td>{{ proformabill.iva.12|stringformat:".2f" }}</td>
            </tr>
            <tr>
                <th>Total a pagar</th><td>{{ proformabill.total|stringformat:".2f" }}</td>
            </tr>
        </table>

        <form action='{% url 'proformabill_emit_to_bill' proformabill.id %}' method='post' class='form spaced-bottom'>
            {% csrf_token %}
            {% buttons %}
                <button type='submit' class='btn btn-primary col-xs-6'>Emitir Factura</button>
                <a href='{% url 'proformabill_detail' proformabill.id %}' class='btn btn-default col-xs-6'>Cancelar</a>
            {% endbuttons %}
        </form>
    </div>

{% endblock %}
